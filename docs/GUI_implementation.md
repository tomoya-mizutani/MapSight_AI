# MapSight AI GUI実装ドキュメント

## 1. 概要

このドキュメントでは、MapSight AI GUIアプリケーションの実装詳細について説明します。

## 2. 技術スタック

- **言語**: Python 3.12
- **GUIフレームワーク**: PyQt6
- **その他の主要ライブラリ**:
  - OpenCV: 動画処理
  - NumPy: データ処理
  - Matplotlib: グラフ描画

## 3. ディレクトリ構造

```
src/
├── gui/
│   ├── main.py        # メインアプリケーション
│   ├── styles.py      # スタイル定義
│   ├── components/    # UIコンポーネント
│   └── utils/        # ユーティリティ関数
```

## 4. コンポーネント設計

### 4.1 メインウィンドウ (`MapSightAI`)

メインウィンドウは以下の主要コンポーネントで構成されています：

1. メニューバー
   - ファイルメニュー
   - 表示メニュー
   - ツールメニュー
   - ヘルプメニュー

2. マップ表示エリア
   - インタラクティブマップ表示
   - プレイヤー位置表示
   - 安全圏表示
   - イベントマーカー

3. データパネル
   - チーム情報表示
   - プレイヤーステータス
   - イベントログ
   - 分析データ

4. タイムラインエリア
   - 再生コントロール
   - タイムスライダー
   - イベントマーカー

## 5. スタイリング

アプリケーションのスタイリングは `styles.py` で一元管理されています：

- ダークテーマベース
- モダンでフラットなデザイン
- 一貫性のある配色
- 視認性の高いコントラスト

## 6. イベントハンドリング

### 6.1 ユーザー操作

- マウスイベント
  - マップのズーム/パン
  - プレイヤー選択
  - イベントマーカー操作

- キーボードショートカット
  - 再生/一時停止: Space
  - フレーム送り: →
  - フレーム戻し: ←
  - ズームイン: Ctrl++
  - ズームアウト: Ctrl+-

### 6.2 データ更新

- リアルタイムデータ更新
- イベント検出と表示
- 分析データの更新

## 7. パフォーマンス最適化

- レンダリングの最適化
  - ダブルバッファリング
  - 描画の間引き

- メモリ管理
  - データのキャッシュ
  - リソースの適切な解放

## 8. エラーハンドリング

- 例外処理
- ユーザーへのフィードバック
- ログ記録

## 9. 今後の拡張性

- プラグインシステム
- カスタムテーマ対応
- 多言語対応
- 追加分析機能

## 10. テスト

- ユニットテスト
- 統合テスト
- UIテスト
- パフォーマンステスト 